<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ror | icps]]></title>
  <link href="http://icps0610.github.io/blog/categories/ror/atom.xml" rel="self"/>
  <link href="http://icps0610.github.io/"/>
  <updated>2018-10-24T11:13:43+08:00</updated>
  <id>http://icps0610.github.io/</id>
  <author>
    <name><![CDATA[icps]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Speak]]></title>
    <link href="http://icps0610.github.io/blog/2018/04/28/speak/"/>
    <updated>2018-04-28T01:13:04+08:00</updated>
    <id>http://icps0610.github.io/blog/2018/04/28/speak</id>
    <content type="html"><![CDATA[<p><button type="button" onclick="click()">Click</button></p>

<script>
    function click(){
    var msg = new SpeechSynthesisUtterance('你是豬豬人');
     msg.lang='zh';
     msg.voice = speechSynthesis.getVoices().filter(function(voice) { 
    return voice.name == 'Whisper'; }
    )[0]; 

    speechSynthesis.speak(msg);
}

</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sso]]></title>
    <link href="http://icps0610.github.io/blog/2018/03/19/sso/"/>
    <updated>2018-03-19T22:28:58+08:00</updated>
    <id>http://icps0610.github.io/blog/2018/03/19/sso</id>
    <content type="html"><![CDATA[<blockquote><blockquote><p>ref <a href="https://github.com/rishabhp/sso-rails-client">https://github.com/rishabhp/sso-rails-client</a></p></blockquote></blockquote>

<pre><code>#Gemfile
gem 'omniauth-oauth2'

#config\environment.rb
require 'icps'

#lib\icps.rb
require 'omniauth-oauth2'
module OmniAuth
  module Strategies
    class Icps &lt; OmniAuth::Strategies::OAuth2

      CUSTOM_PROVIDER_URL = 'http://192.168.0.201:3000'

      option :client_options, {
        :site =&gt;  CUSTOM_PROVIDER_URL,
        :authorize_url =&gt; "#{CUSTOM_PROVIDER_URL}/auth/icps/authorize",
        :access_token_url =&gt; "#{CUSTOM_PROVIDER_URL}/auth/icps/access_token"
      }

      uid do
        raw_info['id']
      end

      info do
        {
          :email =&gt; raw_info['info']['email']
        }
      end

      extra do
        {
          :first_name =&gt; raw_info['extra']['first_name'],
          :last_name  =&gt; raw_info['extra']['last_name']
        }
      end

      def raw_info
        @raw_info ||= access_token.get("/auth/icps/user.json?oauth_token=#{access_token.token}").parsed
      end
    end
  end
end

#config\router.rb
get '/users/auth/:provider/callback' =&gt; 'user_sessions#create'
get '/users/auth/failure' =&gt; 'user_sessions#failure'
match '/logout', :to =&gt; 'user_sessions#destroy', via: :all

#user_sessions_controller.rb
class UserSessionsController &lt; ApplicationController

    def create
        @user = User.from_omniauth(request.env["omniauth.auth"])
        sign_in_and_redirect @user
    end

end


#config\initializers\devise.rb
config.omniauth :icps, Figaro.env.icps_app_id, Figaro.env.icps_secret, scope: 'email', info_fields: 'email, name'

#config\application.yml
icps_app_id: "id"
icps_secret: "secret"

#view.erb
&lt;%= link_to "login", "/users/auth/icps" %&gt;
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Image_view]]></title>
    <link href="http://icps0610.github.io/blog/2018/01/04/image-view/"/>
    <updated>2018-01-04T01:34:16+08:00</updated>
    <id>http://icps0610.github.io/blog/2018/01/04/image-view</id>
    <content type="html"><![CDATA[<p><a href="https://github.com/luciuschoi/lightbox-bootstrap-rails">https://github.com/luciuschoi/lightbox-bootstrap-rails</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Btn_copy_textarea]]></title>
    <link href="http://icps0610.github.io/blog/2017/12/25/btn-copy-textarea/"/>
    <updated>2017-12-25T22:19:24+08:00</updated>
    <id>http://icps0610.github.io/blog/2017/12/25/btn-copy-textarea</id>
    <content type="html"><![CDATA[<blockquote><blockquote><p>ref <a href="https://stackoverflow.com/questions/3739330/copy-textarea-text-to-clipboard-html-javascript">https://stackoverflow.com/questions/3739330/copy-textarea-text-to-clipboard-html-javascript</a></p></blockquote></blockquote>

<p>``` html</p>

<p><TEXTAREA COLS="40" ROWS="8" id="dic" name="dic"  class="form-control">
test</TEXTAREA>
<button class="btn btn-default" onclick="copy_to_clipboard('eic')">Copy</button>
<button class="btn btn-default" onclick="copy_to_clipboard('dic')">Copy</button></p>

<script>
function copy_to_clipboard(id)
{
    document.getElementById(id).select();
    document.execCommand('copy');
}
</script>


<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Production]]></title>
    <link href="http://icps0610.github.io/blog/2017/10/25/production/"/>
    <updated>2017-10-25T23:51:28+08:00</updated>
    <id>http://icps0610.github.io/blog/2017/10/25/production</id>
    <content type="html"><![CDATA[<p><code>rake secret</code> => config/secrets.yml</p>

<h6>不能使用tab要用space</h6>

<p><code>rake db:create db:migrate RAILS_ENV=production</code>
<code>rake assets:precompile RAILS_ENV=production</code>
<code>rails s -e production -p 80</code></p>

<p><code>rails console production 出現 uninitialized constant</code>
<code>spring stop</code></p>
]]></content>
  </entry>
  
 </feed>
