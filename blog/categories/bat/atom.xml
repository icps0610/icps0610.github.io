<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Bat | icps]]></title>
  <link href="http://icps0610.github.io/blog/categories/bat/atom.xml" rel="self"/>
  <link href="http://icps0610.github.io/"/>
  <updated>2018-01-24T19:19:13+08:00</updated>
  <id>http://icps0610.github.io/</id>
  <author>
    <name><![CDATA[icps]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ping_lan2]]></title>
    <link href="http://icps0610.github.io/blog/2016/08/24/ping-lan2/"/>
    <updated>2016-08-24T00:36:40+08:00</updated>
    <id>http://icps0610.github.io/blog/2016/08/24/ping-lan2</id>
    <content type="html"><![CDATA[<pre><code class="bat">@echo off
SETLOCAL ENABLEDELAYEDEXPANSION
for /l %%i in (1,1,254) do (
   ping -n 1 -w 1 192.168.0.%%i &gt; nul
    if !errorlevel! == 0 (
        echo 192.168.0.%%i O
    ) else (
        echo 192.168.0.%%i X 
    )
)
</code></pre>

<pre><code class="bat">@echo off
SETLOCAL ENABLEDELAYEDEXPANSION
FOR /F %%i in (ip.txt) do (
   ping -n 1 -w 1 %%i &gt; nul
    if !errorlevel! == 0 (
        echo %%i O
    ) else (
        echo %%i X 
    )
)
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Route]]></title>
    <link href="http://icps0610.github.io/blog/2016/06/18/route/"/>
    <updated>2016-06-18T01:41:14+08:00</updated>
    <id>http://icps0610.github.io/blog/2016/06/18/route</id>
    <content type="html"><![CDATA[<pre><code>@echo off
route delete 0.0.0.0
route add 0.0.0.0 192.168.43.1 mask 0.0.0.0
route print | find "0.0.0.0"
ping 127.0.0.1 -n 10 > nul
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[System]]></title>
    <link href="http://icps0610.github.io/blog/2016/06/17/system/"/>
    <updated>2016-06-17T17:22:48+08:00</updated>
    <id>http://icps0610.github.io/blog/2016/06/17/system</id>
    <content type="html"><![CDATA[<p>%SystemDrive%: 系統磁碟機, 預設是 C:<br/>
%SystemRoot%: 系統根目錄, 預設是 C:\WinNT 或 C:\Windows<br/>
%SystemDirectory%: 系統目錄, 預設是 C:\WinNT\System32 或 C:\Windows\System32<br/>
%WinDir%: Windows 目錄, 預設是 C:\WinNT 或 C:\Windows<br/>
%ProgramFiles%: 應用程式目錄, 預設是 C:\Program Files<br/>
%Temp%、%Tmp%: 暫存檔目錄, 預設是 C:\Documents and Settings\User\Local Settings\Temp<br/>
%HomeDrive%: 使用者目錄的磁碟機, 預設是 C:<br/>
%HomePath%: 使用者家目錄, 預設是 C:\Documents and Settings\User<br/>
%AllUsersProfile%: All Users 設定檔的資料夾位置<br/>
%AppData%: 目前使用者的 Application Data 資料夾位置<br/>
%CD%: 目前的工作資料夾<br/>
%ClientName%: 目前使用者的 NetBios 電腦名稱<br/>
%CmdCmdLine%: 處理目前命令提示字元視窗命令的 cmd.exe 的完整路徑<br/>
%CmeExtVersion%: 目前 Command Processor Extensions 的版本<br/>
%CommonProgramFiles%: Common Files 資料夾的路徑<br/>
%ComputerName%: 電腦名稱<br/>
%ComSpec%:: 命令提示字元視窗的解譯程式路徑, 通常與 %CmdCmdLine% 相同<br/>
%Date%: 目前的系統日期<br/>
%ErrorLevel%: 最近執行過的命令的錯誤碼; 非零的值表示發生過的錯誤碼<br/>
%HomeShare%: 目前使用者共用資料夾的網路路徑<br/>
%LogonServer%: 目前使用者所登入的網路控制器名稱<br/>
%Number_of_Processors%: 電腦的處理器數量<br/>
%OS%: 作業系統名稱, 其值固定為 Windows_NT<br/>
%Path%: 執行檔的搜尋路徑<br/>
%PathExt%: 作業系統是為執行檔的副檔名<br/>
%Processor_Architecture%: 處理器的架構名稱, 例如x86<br/>
%Processor_Identfier%: 說明處理器的文字 (不一定會有此環境變數)<br/>
%Processor_Level%: 處理器的 Model Number<br/>
%Processor_Revision%: 處理器的 Revision Number<br/>
%Prompt%: 目前解譯程式的命令提示字串<br/>
%Random%: 顯示 0 ~ 32767 之間的十進位整數亂數<br/>
%Sessionname%: 連上終端伺服器的 Session Names<br/>
%Time%: 目前的系統時間<br/>
%UserDomain%: 包含使用者帳號的網域名稱, 或者電腦名稱<br/>
%UserName%: 使用者帳號名稱<br/>
%UserProfile%: 目前使用者的設定檔路徑</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Taskkill]]></title>
    <link href="http://icps0610.github.io/blog/2016/06/17/taskkill/"/>
    <updated>2016-06-17T00:22:40+08:00</updated>
    <id>http://icps0610.github.io/blog/2016/06/17/taskkill</id>
    <content type="html"><![CDATA[<pre><code>@echo off
for /f "delims=" %%i in (file.list) do (
  taskkill /F /IM "%%i"
)
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ping_lan]]></title>
    <link href="http://icps0610.github.io/blog/2016/06/15/ping-lan/"/>
    <updated>2016-06-15T13:09:26+08:00</updated>
    <id>http://icps0610.github.io/blog/2016/06/15/ping-lan</id>
    <content type="html"><![CDATA[<pre><code>@echo off
del ip.tmp 2> nul
del tmp.txt 2>nul
del log.txt 2>nul
SETLOCAL ENABLEDELAYEDEXPANSION

for /l %%i in (1,1,254) do (
   echo ^@echo off > %SystemRoot%\TEMP\%%i.bat
   echo ping -n 1 -w 1000 192.168.1.%%i ^>nul >> %SystemRoot%\TEMP\%%i.bat
   echo if %%errorlevel%% == 0 echo 192.168.1.%%i ^>^> ip.tmp >> %SystemRoot%\TEMP\%%i.bat
   echo exit >> %SystemRoot%\TEMP\%%i.bat
   start %SystemRoot%\TEMP\%%i.bat
)
echo 正在尋找有回應的主機
pause
echo 已找到有回應的主機
type ip.tmp
echo 分析主機名稱中..
for /l %%i in (1,1,254) do del %SystemRoot%\TEMP\%%i.bat
for /f %%i in (ip.tmp) do (
   ping -a -n 1 -w 100 %%i > tmp.txt
   set line=0
   for /f "tokens=2 delims= " %%j in (tmp.txt) do (
      set /a line=!line!+1
      if !line! == 1 echo %%i %%j & echo %%i %%j >>log.txt
   )
)
del ip.tmp 2> nul
del tmp.txt 2>nul
pause
</code></pre>

]]></content>
  </entry>
  
 </feed>
