---
layout: post
title: "holiday"
date: 2018-04-11 23:58:57 +0800
comments: true
categories: ruby
---

### http://www.319papago.idv.tw/holiday/2017-hr/2017_HR.html
``` ruby
require 'rubyXL'

def holiday
    file_path = '107.xlsx'
    workbook  = RubyXL::Parser.parse(file_path)
    worksheet = workbook[0]
    xl = [1,  8, 15]
    yl = [4, 16, 28, 42]
    hl = [5,  5,  6,  6]
    (0..3).map do |y|
        (0..2).map do |x|
            (0..(7 * hl[y]-1)).map do |i|
                cx = xl[x] + i % 7
                cy = yl[y] + (i / 7) * 2
                cell = worksheet[cy][cx]
                cell.fill_color if cell.value
            end.compact
        end
    end.flatten(1)
end

def check_holiday(data, m, d)
    data[m-1][d-1] == "FFFF99FF" ? true : false
end

def check_check_holiday(h)
    ans = [true, false, true, true, true, false, true, false, true, true, true, false]
    ans.each_with_index do |a, idx|
        idx += 1
        if not check_holiday(h, idx, idx) == a
            return false
        end
    end
    return true
end

h = holiday
p check_check_holiday(h)
```